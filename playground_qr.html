<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>QR Playground</title>

<style>
    #phrase {
        display: block;
        width: 90%;
        margin-bottom: 10px;
    }
    
    .hidden, .hide {display: none !important;}
    .show {display: block !important;}
</style>

</head>
<body>

<!-- Seed Phrase -->
<p>BIP39 Seed Phrase:</p>
<textarea
    id="phrase"
    class="phrase private-data form-control"
    data-show-qr=""
    autocomplete="off"
    autocorrect="off"
    autocapitalize="none"
    spellcheck="false"
></textarea>

<div class="qr-hint">Click field to toggle QR</div>
<div class="qr-container">
    <div class="qr-hider hidden">
        <div class="qr-image"></div>
    </div>
</div>

<!-- Required for QR Code -->
<script src="kjua.min.js"></script>
<script src="jquery_3.2.1.js"></script>
<script>
$(function() {
    $("#phrase").val('produce sheriff habit suspect long gather chuckle news minute board train syrup cry amazing report collect tower soap tool museum concert evoke roof afraid');

    const DOM = {
        qrContainer: $(".qr-container"),
        qrHider: $(".qr-container .qr-hider"),
        qrImage: $(".qr-container .qr-image")
    }
    
    let lastContent = "";
    let isVisible = false;
    
    $(document).on("click", "[data-show-qr]", function (e) {
        e.stopPropagation();
        let content = this.value || this.textContent.trim();
        if (!content) return;
        
        if (isVisible && content === lastContent) {
            hideQr();
            return;
        }
        
        showQr(content);
    });
    
    function showQr(content) {
        lastContent = content;
        isVisible = true;

        DOM.qrImage.empty();

        const qrEl = kjua({
            text: content,
            render: "canvas",
            size: 310,
            ecLevel: "H"
        });

        DOM.qrImage.append(qrEl);

        DOM.qrHider.removeClass("hidden");
        DOM.qrContainer.removeClass("hidden");
        
        
        $(".qr-hint").html('Click field to toggle QR (Esc to hide)');
    }
    
    function hideQr() {
        isVisible = false;
        DOM.qrContainer.addClass("hidden");
        
        $(".qr-hint").html('Click field to toggle QR');
    }
    
    // Hide if QR clicked
    DOM.qrContainer.on('click', function(e) {
        hideQr();
    });
    
    // Hide if Esc pressed
    $(document).on('keydown', function(e) {
        if (e.key === "Escape") {
            hideQr();
        }
    });
});
</script>

</body>
</html>